<% project_name = 'inspec-gcp-project' -%>
<% ssl_policy = {'name' => 'my_ssl_policy', 'min_tls_version' => 'TLS_1_2', 'profile' => 'CUSTOM', 'custom_feature' => 'TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384', 'custom_feature2' => 'TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384'} -%>
<% if doc_generation -%>
<% else # if doc_generation -%>
project_name = attribute('project_name', default: '<%= project_name -%>')
ssl_policy = attribute('ssl_policy', default: <%= ssl_policy -%>)

<% end # if doc_generation -%>
resource = google_compute_ssl_policies({project: <%= doc_generation ? "'#{project_name}'" : "project_name" -%>})

describe resource do
  it { should exist }
  its('names') { should include <%= doc_generation ? "'#{ssl_policy['name']}'" : "ssl_policy['name']" -%> }
  its('profiles') { should include <%= doc_generation ? "'#{ssl_policy['profile']}'" : "ssl_policy['profile']" -%> }
end